panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = alpha_2,
size = subdivision_count,
fill = predominant_type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
legend.text = element_text(size = 14),
axis.text.x = element_text(size = 14, family = "Candara"),
axis.text.y = element_markdown(size = 14, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
View(country_subdivisions)
countries <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-11-12/countries.csv')
View(countries)
data$name <- countries$name
country_subdivisions$name <- countries$name
countries <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-11-12/countries.csv')
country_subdivisions <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-11-12/country_subdivisions.csv')
country_subdivisions$name <- countries$name
# Merge the 'bubble_data' with the 'countries' dataset to get the official country names
data_1 <- merge(data, countries[, .(alpha_2, name)], by = "alpha_2", all.x = TRUE)
View(data_1)
country_subdivisions[, .(subdivision_count = sum(.N)]
data <- country_subdivisions[, .(subdivision_count = sum(.N),
data <- country_subdivisions[, .(subdivision_count = sum(.N),
by = alpha_2]
data <- country_subdivisions[, .(subdivision_count = sum(.N),
by = alpha_2]
data <- country_subdivisions[, .(subdivision_count = sum(.N)]
type[which.max(.N)])
# Step 1: Count the subdivisions per type for each country
subdiv_count <- country_subdivisions[, .(subdivision_count = .N), by = .(alpha_2, type)]
View(subdiv_count)
# Step 2: For each country, find the most frequent subdivision type
predominant_subdiv <- subdiv_count[, .SD[which.max(subdivision_count)], by = alpha_2]
View(predominant_subdiv)
bubble_data_with_names <- merge(predominant_subdiv, countries[, .(alpha_2, name)], by = "alpha_2", all.x = TRUE)
rm(list = ls())
gc()
countries <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-11-12/countries.csv')
country_subdivisions <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-11-12/country_subdivisions.csv')
# Count the subdivisions per type for each country
subdiv_count <- country_subdivisions[, .(subdivision_count = .N), by = .(alpha_2, type)]
# For each country, find the most frequent subdivision type
predominant_subdiv <- subdiv_count[, .SD[which.max(subdivision_count)], by = alpha_2]
data <- merge(predominant_subdiv, countries[, .(alpha_2, name)], by = "alpha_2", all.x = TRUE)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = alpha_2,
size = subdivision_count,
fill = predominant_type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
legend.text = element_text(size = 14),
axis.text.x = element_text(size = 14, family = "Candara"),
axis.text.y = element_markdown(size = 14, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
View(data)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = alpha_2,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
legend.text = element_text(size = 14),
axis.text.x = element_text(size = 14, family = "Candara"),
axis.text.y = element_markdown(size = 14, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
legend.text = element_text(size = 14),
axis.text.x = element_text(size = 14, family = "Candara"),
axis.text.y = element_markdown(size = 14, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
legend.text = element_text(size = 14),
axis.text.x = element_text(size = 6, family = "Candara"),
axis.text.y = element_markdown(size = 6, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 26, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 18, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 10, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 15, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.2, 7)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 10, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.5, 5)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 10, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.5, 8)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 10, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.5, 8)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 5, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 14, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = name,
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.5, 8)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 5, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 10, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
# Bubble plot
ggplot(data) +
geom_point(
aes(x = subdivision_count, y = order(-name),
size = subdivision_count,
fill = type
),
shape = 21, , stroke = .15,
alpha = 0.75
) +
scale_size(range = c(0.5, 8)) +
theme_minimal() +
labs(title = "Country Subdivision Counts and Types",
x = "Number of Subdivisions",
y = "Country",
# subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
# labs(title = "Top 20 Longest-Serving Rulers (Monarchs & Presidents)",
#      subtitle = "<b>Female</b> leaders are a rare sight among the longest-serving monarchs and presidents, with only <b>3</b> appearing in the top 20.",
#      caption = "Source: <b>Democracy and Dictatorship Dataset</b> | Graphic: <b>Natasa Anastasiadou</b>",
#      x = "", y = "") +
theme(
legend.position = "none",
# legend.title = element_blank(),
# legend.text = element_text(size = 14),
axis.text.x = element_text(size = 8, family = "Candara"),
axis.text.y = element_markdown(size = 8, family = "Candara"), # Enable markdown for color
panel.grid.major = element_line(linewidth = .35, color = "grey85"),
panel.grid.minor = element_line(linewidth = .35, color = "grey85", linetype = "dashed"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 5, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 25), size = 10, family = "Candara", hjust = 1),
plot.margin = margin(20, 20, 20, 20),
plot.background = element_rect(fill = "#e4e4e3", color = NA)
)
