legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, family = "Candara"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 18, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 14, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b> values represent states with an <b>increase</b> in the number of households lacking plumbing in 2023, <br>while <span style='color: #B24745;'>negative</span> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b></b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, family = "Candara"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 18, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 14, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b> values represent states with an <b>increase</b> in the number of households lacking plumbing in 2023, <br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b></b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, family = "Candara"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 18, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 14, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 10, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b> values represent states with an <b>increase</b> in the number of households lacking plumbing in 2023, <br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b></b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 10, height = 10, units = "in", dpi = 600
)
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b> values represent states with an <b>increase</b> in the number of households lacking plumbing in 2023, <br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b></b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b> values represent states with an <b>increase</b> in the number of households lacking plumbing in 2023, <br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
df1[state == "Arizona", .(year, plumbing)]
df2[state == "Arizona", .(year, plumbing)]
df2[state == "Arizona", .(year, plumbing)] - df1[state == "Arizona", .(year, plumbing)]
df1[state == "Arizona", .(plumbing_2022 = sum(plumbing))]
df2[state == "Arizona", .(plumbing_2023 = sum(plumbing))]
df1[state == "California", .(plumbing_2022 = sum(plumbing))]
df2[state == "California", .(plumbing_2023 = sum(plumbing))]
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 0.5, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 0.5, vjust = 0.5, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.35, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, vjust = 0.5, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
df1[state == "Colorado", .(plumbing_2022 = sum(plumbing))]
df2[state == "Colorado", .(plumbing_2023 = sum(plumbing))]
ggsave(
plot = gr, filename = "Rplot.png",
width = 12, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.45, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4.5, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, vjust = 0.5, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 16, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 12, height = 10, units = "in", dpi = 600
)
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.45, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4.5, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, vjust = 0.5, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 20, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 15, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 11, height = 10, units = "in", dpi = 600
)
gr = ggplot(p, aes(x = state, y = plumbing_change)) +
geom_segment(
aes(x = state, xend = state,
y = 0 , yend = plumbing_change),
color = "grey35", linewidth = 0.45, lineend = "round"
) +
geom_point( aes(fill = type, color = type), size = 4.5, shape = 21, stroke = .15) +
# Define custom colors for each type
scale_fill_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97")) +
scale_color_manual(values = c("Negative" = "#B24745", "Positive" = "#79AF97") |> darken(.25), guide = "none") +
theme_minimal() +
# labs(
#     title = "Percent of Households Lacking Plumbing by State: 2022 vs 2023",
#     x = "State",
#     y = "Percent of Households Lacking Plumbing"
# ) +
labs(
title = "Number of Households Lacking Plumbing by State: 2022 vs 2023",
subtitle = "<b><span style='color: #79AF97; font-weight: bold;'>Positive</span></b>
values represent states with an <b>increase</b> in the number of households lacking plumbing from 2022 to 2023,
<br>while <b><span style='color: #B24745;'>negative</span></b> values indicate a <b>decrease</b>.</br>",
caption = "Source: <b>Water insecurity data</b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme(
legend.position = "none",
plot.margin = margin(20, 20, 20, 20),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
axis.text.x = element_markdown(angle = 90, hjust = 1, vjust = 0.5, family = "Candara", size = 12),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_markdown(size = 19, face = "bold", hjust = 0.5, family = "Candara"),
plot.subtitle = element_markdown(size = 14, hjust = 0.5, family = "Candara", color = "grey30"),
plot.caption = element_markdown(margin = margin(t = 35), size = 10, family = "Candara", hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA)
)
gr
ggsave(
plot = gr, filename = "Rplot.png",
width = 10, height = 10, units = "in", dpi = 600
)
