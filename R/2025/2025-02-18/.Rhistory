rm(list = ls())
gc()
library(data.table)
library(ggplot2)
library(stringr)
library(extrafont)
library(colorspace)
library(ggtext)
agencies <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-02-18/agencies.csv')
View(agencies)
# Fix longitude column name if needed
colnames(agencies)[colnames(agencies) == "longitude"] <- "longitude"
View(agencies)
# Convert nibrs_start_date to Date format
agencies$nibrs_start_date <- as.Date(agencies$nibrs_start_date, format="%Y-%m-%d")
# 1. Map of Law Enforcement Agencies
usa_map <- ggplot(agencies, aes(x = longitude, y = latitude, color = is_nibrs)) +
geom_point(alpha = 0.5) +
borders("state", colour="gray50", fill=NA) +
theme_minimal() +
labs(title = "Law Enforcement Agencies Across the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude") +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"), labels = c("Not in NIBRS", "NIBRS Participant"))
# 2. NIBRS Participation by State
nibrs_summary <- agencies %>%
group_by(state) %>%
summarise(percent_nibrs = mean(is_nibrs, na.rm = TRUE))
library(ggplot2)
library(dplyr)
library(ggthemes)
library(usmap)
library(scales)
library(lubridate)
# 1. Map of Law Enforcement Agencies
usa_map <- ggplot(agencies, aes(x = longitude, y = latitude, color = is_nibrs)) +
geom_point(alpha = 0.5) +
borders("state", colour="gray50", fill=NA) +
theme_minimal() +
labs(title = "Law Enforcement Agencies Across the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude") +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"), labels = c("Not in NIBRS", "NIBRS Participant"))
usa_map
# 2. NIBRS Participation by State
nibrs_summary <- agencies %>%
group_by(state) %>%
summarise(percent_nibrs = mean(is_nibrs, na.rm = TRUE))
state_plot <- ggplot(nibrs_summary, aes(x = reorder(state, percent_nibrs), y = percent_nibrs)) +
geom_col(fill = "steelblue") +
coord_flip() +
theme_minimal() +
labs(title = "NIBRS Participation by State",
subtitle = "Percentage of agencies reporting to NIBRS",
x = "State", y = "Percentage") +
scale_y_continuous(labels = percent_format())
state_plot
# 3. Agency Type Distribution
agency_type_plot <- ggplot(agencies, aes(x = agency_type)) +
geom_bar(fill = "darkblue", alpha = 0.7) +
coord_flip() +
theme_minimal() +
labs(title = "Distribution of Law Enforcement Agency Types",
x = "Agency Type", y = "Count")
agency_type_plot
# 4. Trends in NIBRS Adoption Over Time
nibrs_trend <- agencies %>%
filter(!is.na(nibrs_start_date)) %>%
mutate(year = year(nibrs_start_date)) %>%
group_by(year) %>%
summarise(count = n())
nibrs_trend
trend_plot <- ggplot(nibrs_trend, aes(x = year, y = count)) +
geom_line(color = "blue", size = 1.2) +
geom_point(color = "red", size = 2) +
theme_minimal() +
labs(title = "Trend of NIBRS Adoption Over Time",
x = "Year", y = "Number of Agencies Joining NIBRS")
trend_plot
# Display plots
print(usa_map)
print(state_plot)
print(agency_type_plot)
print(trend_plot)
# 5. Stream Plot for NIBRS Adoption Over Time by State
nibrs_stream <- agencies %>%
filter(!is.na(nibrs_start_date)) %>%
mutate(year = year(nibrs_start_date)) %>%
group_by(year, state) %>%
summarise(count = n(), .groups = "drop")
stream_plot <- ggplot(nibrs_stream, aes(x = year, y = count, fill = state)) +
geom_area(position = "stack", alpha = 0.8) +
theme_minimal() +
labs(title = "Stream Plot of NIBRS Adoption Over Time by State",
x = "Year", y = "Number of Agencies Joining NIBRS",
fill = "State")
stream_plot
# 1. Map of Law Enforcement Agencies
usa_map <- ggplot(agencies, aes(x = longitude, y = latitude, color = is_nibrs)) +
geom_point(alpha = 0.5) +
borders("state", colour="gray50", fill=NA) +
theme_minimal() +
labs(title = "Law Enforcement Agencies Across the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude") +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"), labels = c("Not in NIBRS", "NIBRS Participant"))
usa_map
rm(list = ls())
gc()
agencies <- fread('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-02-18/agencies.csv')
View(agencies)
# Base map with state borders
usa_states <- map_data("state")
View(usa_states)
# Plot the agencies on the map
ggplot() +
geom_polygon(data = usa_states, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
geom_point(data = agencies, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
df = agencies[!is.na(latitude) & !is.na(longitude), ]
df = agencies[!is.na(latitude) & !is.na(longitude), ]
library(maps)
# Base map with state borders
usa_states <- map_data("state")
# Plot the agencies on the map
ggplot() +
geom_polygon(data = usa_states, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
geom_point(data = agencies, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
# Plot the agencies on the map
ggplot() +
geom_polygon(data = df, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
geom_point(data = agencies, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
# Plot the agencies on the map
ggplot() +
geom_polygon(data = df, aes(x = longitude, y = latitude, group = group),
fill = "gray90", color = "white") +
geom_point(data = agencies, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
View(agencies)
# Plot the agencies on the map
ggplot() +
geom_polygon(data = usa_states, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
geom_point(data = agencies, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
View(usa_states)
df <- agencies[!is.na(agencies$latitude) & !is.na(agencies$longitude), ]
# Base map with state borders
usa_states <- map_data("state")
# Plot the agencies on the map
ggplot() +
geom_polygon(data = usa_states, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
geom_point(data = df, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
summary(df$latitude)
summary(df$longitude)
df <- df[latitude >= 24 & latitude <= 49 & longitude >= -125 & longitude <= -66]
# Plot the agencies on the map
ggplot() +
geom_polygon(data = usa_states, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
geom_point(data = df, aes(x = longitude, y = latitude, color = is_nibrs),
alpha = 0.6, size = 1) +
scale_color_manual(values = c("FALSE" = "red", "TRUE" = "blue"),
labels = c("Not in NIBRS", "NIBRS Participant")) +
theme_minimal() +
labs(title = "Law Enforcement Agencies in the U.S.",
subtitle = "Colored by NIBRS Participation",
x = "Longitude", y = "Latitude",
color = "NIBRS Status") +
theme(legend.position = "bottom")
