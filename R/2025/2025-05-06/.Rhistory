) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
annotate(
"text",
x = 1, y = 45,
label = "*Science, Technology, Engineering, and Mathematics",
hjust = 0,
size = 3,
lineheight = .7,
fontface = "bold",
color = col[1]
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
annotate(
"text",
x = 1, y = 45,
label = "*Science, Technology, Engineering, and Mathematics",
hjust = 0,
size = 3,
lineheight = .7,
fontface = "bold",
color = col[1]
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
annotate(
"text",
x = 1, y = 45,
label = "*Science, Technology, Engineering, and Mathematics",
hjust = 0,
size = 3,
lineheight = .7,
fontface = "bold",
color = col[1]
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
df_expanded
df_expanded$directorate <- ifelse(df_expanded$directorate == "STEM Education", "*STEM Education", df_expanded$directorate)
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
df_expanded
df_expanded$directorate
df_expanded$directorate <- ifelse(df_expanded$directorate == "STEM Education", "*STEM Education", df_expanded$directorate)
df_expanded$directorate
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
df_expanded
str(df_expanded$directorate)
df = nsf_terminations[, .(directorate)]
df = df[!is.na(directorate), .N, by = directorate]
df$directorate <- df$directorate |> str_remove_all('^"|"$') |> str_wrap(width = 15)
df$directorate <- ifelse(df$directorate == "STEM Education", "*STEM Education", df$directorate)
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
df$directorate <- df$directorate |> str_remove_all('^"|"$') |> str_wrap(width = 15)
df$directorate <- ifelse(df$directorate == "STEM Education", "*STEM Education", df$directorate)
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
df = nsf_terminations[, .(directorate)]
df = df[!is.na(directorate), .N, by = directorate]
df$directorate <- df$directorate |> str_remove_all('^"|"$') |> str_wrap(width = 15)
df$directorate <- ifelse(df$directorate == "STEM Education", "*STEM Education", df$directorate)
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
df = nsf_terminations[, .(directorate)]
df = df[!is.na(directorate), .N, by = directorate]
df$directorate <- df$directorate |> str_remove_all('^"|"$') |> str_wrap(width = 15)
df$directorate <- ifelse(df$directorate == "STEM Education", "*STEM Education", df$directorate)
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
df = df[!is.na(directorate), .N, by = directorate]
df$directorate <- df$directorate |> str_remove_all('^"|"$') |> str_wrap(width = 15)
df$directorate
df = nsf_terminations[, .(directorate)]
df = df[!is.na(directorate), .N, by = directorate]
df$directorate
df$directorate <- df$directorate |> str_remove_all('^"|"$') |> str_wrap(width = 15)
df$directorate
df = df[!is.na(directorate), .N, by = directorate]
df$directorate <- df$directorate |> str_remove_all('^"+|"+$') |> str_wrap(width = 15)
df$directorate <- ifelse(df$directorate == "STEM Education", "*STEM Education", df$directorate)
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
df = nsf_terminations[, .(directorate)]
df = df[!is.na(directorate), .N, by = directorate]
df$directorate <- df$directorate |> str_remove_all('^"+|"+$') |> str_wrap(width = 15)
df$directorate
df$directorate <- ifelse(df$directorate == "STEM Education", "*STEM Education", df$directorate)
# Sort by number of terminations descending
setorder(df, -N)
df[, directorate := factor(directorate, levels = directorate)]
# One point per termination
df_expanded <- df[, .(directorate = rep(directorate, times = N))]
# Create grid layout: each directorate starts at (0,0)
df_expanded[, id := seq_len(.N), by = directorate]
df_expanded[, `:=`(
x = (id - 1) %% 10,
y = (id - 1) %/% 10  # negative y to grow downward
)]
col = paletteer_c("ggthemes::Sunset-Sunrise Diverging", 9)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 10),
strip.text = element_text(size = 10),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
ggsave(
plot = gr, filename = "plot.png",
width = 10, height = 8, units = "in", dpi = 600
)
gr = df_expanded |>
ggplot(aes(x = x, y = y)) +
geom_point(aes(fill = directorate), size = 3, shape = 21, color = "white", stroke = .15) +
facet_wrap(~directorate, nrow = 1, strip.position = "bottom") +
coord_equal() +
scale_fill_manual(values = col) +
labs(
title = "Grants Terminated Across Directorates",
subtitle = "<b>Each dot</b> represents a <b>terminated award</b> within a U.S. National Science Foundation (NSF) directorate.",
caption = "*Science, Technology, Engineering, and Mathematics <br> <br>Source: <b>U.S. NSF Grant Terminations data </b> | Graphic: <b>Natasa Anastasiadou</b>"
) +
theme_minimal(base_family = "Candara") +
theme(
legend.position = "none",
axis.title = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_text(size = 9.5),
strip.text = element_text(size = 9.5),
panel.grid.major = element_line(linewidth = 0.45, color = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_markdown(size = 16, face = "bold", hjust = 0.5, margin = margin(t = 15, b = 5)),
plot.subtitle = element_markdown(size = 12, hjust = 0.5, color = "grey30", margin = margin(t = 2.5, b = 25)),
plot.caption = element_markdown(margin = margin(t = 35), size = 8, hjust = 1),
plot.background = element_rect(fill = "grey93", color = NA),
plot.margin = margin(20, 20, 20, 20)
)
gr
ggsave(
plot = gr, filename = "plot.png",
width = 10, height = 8, units = "in", dpi = 600
)
